(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{35:function(n,t,e){"use strict";e.r(t);var r=e(1),c=e(0),i=e(20),o=e.n(i),a=e(9),u=e(5),s=e(4),j="token",b=function(n){localStorage.setItem(j,n)},d="https://student-json-api.lidemy.me",l=function(){var n=localStorage.getItem(j);return fetch("".concat(d,"/me"),{headers:{authorization:"Bearer ".concat(n)}}).then((function(n){return n.json()}))},f=Object(c.createContext)(null),O=e(2);function h(){var n=Object(u.a)(["\n  color: red;\n"]);return h=function(){return n},n}var p=s.b.div(h());function x(){var n=Object(c.useContext)(f).setUser,t=Object(c.useState)(""),e=Object(a.a)(t,2),i=e[0],o=e[1],u=Object(c.useState)(""),s=Object(a.a)(u,2),j=s[0],h=s[1],x=Object(c.useState)(),v=Object(a.a)(x,2),g=v[0],m=v[1],y=Object(O.f)();return Object(r.jsxs)("form",{onSubmit:function(t){m(null),function(n,t){return fetch("".concat(d,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:n,password:t})}).then((function(n){return n.json()}))}(i,j).then((function(t){if(0===t.ok)return m(t.message);b(t.token),l().then((function(t){if(1!==t.ok)return b(null),m(t.toString());n(t.data),y.push("/")}))}))},children:[Object(r.jsxs)("div",{children:["username:"," ",Object(r.jsx)("input",{value:i,onChange:function(n){return o(n.target.value)}})]}),Object(r.jsxs)("div",{children:["password"," ",Object(r.jsx)("input",{type:"password",value:j,onChange:function(n){return h(n.target.value)}})]}),Object(r.jsx)("button",{children:"\u767b\u5165"}),g&&Object(r.jsx)(p,{children:g})]})}var v=e(10);function g(){var n=Object(u.a)(["\n  color: rgba(0, 0, 0, 0.8);\n"]);return g=function(){return n},n}function m(){var n=Object(u.a)(["\n  font-size: 24px;\n  color: #333;\n  text-decoration: none;\n"]);return m=function(){return n},n}function y(){var n=Object(u.a)(["\n  border-bottom: 1px solid rgba(0, 12, 34, 0.2);\n  padding: 16px;\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n"]);return y=function(){return n},n}function w(){var n=Object(u.a)(["\n  width: 80%;\n  margin: 0 auto;\n"]);return w=function(){return n},n}var S=s.b.div(w()),k=s.b.div(y()),C=Object(s.b)(v.b)(m()),z=s.b.div(g());function _(n){var t=n.post;return Object(r.jsxs)(k,{children:[Object(r.jsx)(C,{to:"/posts/".concat(t.id),children:t.title}),Object(r.jsx)(z,{children:new Date(t.createdAt).toLocaleString()})]})}function $(){var n=Object(c.useState)([]),t=Object(a.a)(n,2),e=t[0],i=t[1];return Object(c.useEffect)((function(){fetch("".concat(d,"/posts?_sort=createdAt&_order=desc")).then((function(n){return n.json()})).then((function(n){return i(n)}))}),[]),Object(r.jsx)(S,{children:e.map((function(n){return Object(r.jsx)(_,{post:n},n.id)}))})}function E(){var n=Object(u.a)(["\n  display: flex;\n  align-items: center;\n\n  "," {\n    margin-left: 64px;\n  }\n"]);return E=function(){return n},n}function I(){var n=Object(u.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  box-sizing: border-box;\n  width: 100px;\n  cursor: pointer;\n  color: black;\n  text-decoration: none;\n\n  ","\n"]);return I=function(){return n},n}function J(){var n=Object(u.a)(["\n  display: flex;\n  align-items: cneter;\n  height: 64px;\n"]);return J=function(){return n},n}function U(){var n=Object(u.a)(["\n  font-size: 32px;\n  font-weight: bold;\n"]);return U=function(){return n},n}function A(){var n=Object(u.a)(["\n  height: 64px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n  padding: 0px 32px;\n  box-sizing: border-box;\n"]);return A=function(){return n},n}var B=s.b.div(A()),P=s.b.div(U()),D=s.b.div(J()),L=Object(s.b)(v.b)(I(),(function(n){return n.$active&&"\n    background: rgba(0, 0, 0, 0.1);\n  "})),N=s.b.div(E(),D);function T(){var n=Object(O.g)(),t=Object(O.f)(),e=Object(c.useContext)(f),i=e.user,o=e.setUser;return Object(r.jsxs)(B,{children:[Object(r.jsxs)(N,{children:[Object(r.jsx)(P,{children:"\u6211\u7684\u7b2c\u4e00\u500b\u90e8\u843d\u683c"}),Object(r.jsxs)(D,{children:[Object(r.jsx)(L,{to:"/",$active:"/"===n.pathname,children:"\u9996\u9801"}),i&&Object(r.jsx)(L,{to:"/new-post",$active:"/new-post"===n.pathname,children:"\u767c\u5e03\u6587\u7ae0"})]})]}),Object(r.jsxs)(D,{children:[!i&&Object(r.jsx)(L,{to:"/login",$active:"/login"===n.pathname,children:"\u767b\u5165"}),i&&Object(r.jsx)(L,{onClick:function(){b(""),o(null),"/"!==n.pathname&&t.push("/")},children:"\u767b\u51fa"})]})]})}function q(){var n=Object(u.a)(["\n  padding-top: 64px;\n"]);return q=function(){return n},n}var F=s.b.div(q());var G=function(){var n=Object(c.useState)(null),t=Object(a.a)(n,2),e=t[0],i=t[1];return Object(c.useEffect)((function(){l().then((function(n){n.ok&&i(n.data)}))}),[]),Object(r.jsx)(f.Provider,{value:{user:e,setUser:i},children:Object(r.jsx)(F,{children:Object(r.jsxs)(v.a,{children:[Object(r.jsx)(T,{}),Object(r.jsxs)(O.c,{children:[Object(r.jsx)(O.a,{exact:!0,path:"/",children:Object(r.jsx)($,{})}),Object(r.jsx)(O.a,{path:"/login",children:Object(r.jsx)(x,{})})]})]})})})};o.a.render(Object(r.jsx)(s.a,{theme:{colors:{primary_300:"#3333dd",primary_400:"#e33e3e",primary_500:"#af0505"}},children:Object(r.jsx)(G,{})}),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.2b2cf8c5.chunk.js.map